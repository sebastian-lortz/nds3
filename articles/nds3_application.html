<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en-US">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>nds3_application • nds3</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="nds3_application">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">nds3</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.1.000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item"><a class="nav-link" href="../articles/index.html">Articles</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/sebastian-lortz/nds3/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>nds3_application</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/sebastian-lortz/nds3/blob/main/vignettes/nds3_application.Rmd" class="external-link"><code>vignettes/nds3_application.Rmd</code></a></small>
      <div class="d-none name"><code>nds3_application.Rmd</code></div>
    </div>

    
    
<p>Install <code>nds3</code> from Github.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># install devtools if needed</span></span>
<span><span class="kw">if</span> <span class="op">(</span><span class="op">!</span><span class="fu"><a href="https://rdrr.io/r/base/ns-load.html" class="external-link">requireNamespace</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span><span class="fu"><a href="https://rdrr.io/r/utils/install.packages.html" class="external-link">install.packages</a></span><span class="op">(</span><span class="st">"devtools"</span><span class="op">)</span><span class="op">}</span></span>
<span></span>
<span><span class="co"># install from GitHub</span></span>
<span><span class="fu">devtools</span><span class="fu">::</span><span class="fu">install_github</span><span class="op">(</span><span class="st">"sebastian-lortz/nds3"</span><span class="op">)</span></span></code></pre></div>
<p>Load the <code>nds3</code> package.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/sebastian-lortz/nds3" class="external-link">nds3</a></span><span class="op">)</span></span></code></pre></div>
<div class="section level2">
<h2 id="anova-module">ANOVA Module<a class="anchor" aria-label="anchor" href="#anova-module"></a>
</h2>
<p>As part of the Open Science Collaboration’s large‐scale effort to
estimate the replicability of psychological findings
(Open-Science-Collaboration, 2015), many original datasets remain
unavailable. In the study by Reynolds and Besner (2008) on contextual
effects in reading aloud, participants’ response times to exception
words and nonwords were measured under predictable switch and stay
sequences to probe dynamic pathway control in skilled reading [<a href="https://osf.io/hasfu/" class="external-link uri">https://osf.io/hasfu/</a>]. In
the following steps, I applied nds3 to demonstrate how it’s ANOVA module
can generate a fully synthetic dataset matching the reported summary
estimates.</p>
<p>I began by extracting the relevant parameters from the article.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">16</span></span>
<span><span class="va">levels</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">2</span><span class="op">)</span></span>
<span><span class="va">target_group_means</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">543</span>, <span class="fl">536</span>, <span class="fl">614</span>, <span class="fl">618</span><span class="op">)</span></span>
<span><span class="va">factor_type</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"within"</span>, <span class="st">"within"</span><span class="op">)</span></span>
<span><span class="va">formula</span> <span class="op">&lt;-</span> <span class="st">"outcome ~ Factor1 * Factor2 + Error(ID / (Factor1 * Factor2))"</span></span>
<span><span class="va">integer</span> <span class="op">&lt;-</span> <span class="cn">FALSE</span></span></code></pre></div>
<p>Factor2 and Interaction effects are reported as F &lt; 1, thus, I set
arbitrary values</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">target_f_vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>effect <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Factor1"</span>, <span class="st">"Factor2"</span>, <span class="st">"Factor1:Factor2"</span><span class="op">)</span>,</span>
<span>                          F <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30.5</span>, <span class="fl">0.0</span>, <span class="fl">0.2</span><span class="op">)</span><span class="op">)</span></span></code></pre></div>
<p>I then computed a plausible response time range [L,U] from the pooled
<code>MSE = 3070</code> using</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">L</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">target_group_means</span><span class="op">)</span> <span class="op">-</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">floor</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">3070</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">U</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="va">target_group_means</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/Round.html" class="external-link">ceiling</a></span><span class="op">(</span><span class="fl">3</span> <span class="op">*</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html" class="external-link">sqrt</a></span><span class="op">(</span><span class="fl">3070</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">L</span></span>
<span><span class="co">#&gt; [1] 370</span></span>
<span><span class="va">U</span></span>
<span><span class="co">#&gt; [1] 785</span></span>
<span><span class="va">range</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">370</span>,<span class="fl">785</span><span class="op">)</span></span></code></pre></div>
<p>Next, I ran the ANOVA module with a small <code>max_step</code> to
avoid early convergence given the coarse target precision and otherwise
default hyperparameters.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result.aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optim_aov.html">optim_aov</a></span><span class="op">(</span>N <span class="op">=</span> <span class="va">N</span>,</span>
<span>                        levels <span class="op">=</span> <span class="va">levels</span>,</span>
<span>                        target_group_means <span class="op">=</span> <span class="va">target_group_means</span>,</span>
<span>                        target_f_list <span class="op">=</span> <span class="va">target_f_vec</span>,</span>
<span>                        factor_type <span class="op">=</span> <span class="va">factor_type</span>,</span>
<span>                        range <span class="op">=</span> <span class="va">range</span>,</span>
<span>                        formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>                        integer <span class="op">=</span> <span class="va">integer</span>,</span>
<span>                        max_step <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>                        tolerance <span class="op">=</span> <span class="fl">1e-8</span>,</span>
<span>                        max_iter <span class="op">=</span> <span class="fl">1e3</span>,</span>
<span>                        init_temp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        cooling_rate <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%</span></span></code></pre></div>
<p>The optimization converged exactly. Inspecting</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result.aov</span><span class="op">)</span></span>
<span><span class="co">#&gt; nds3 Object Summary</span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Achieved Loss of Optimization:  0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; RMSE of F statistics:  0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Factorial Model:</span></span>
<span><span class="co">#&gt; outcome ~ Factor1 * Factor2 + Error(ID/(Factor1 * Factor2)) </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Group Means:</span></span>
<span><span class="co">#&gt; [1] 543 536 614 618</span></span></code></pre></div>
<p>confirms that the simulated data reproduce the published cell means
and F-statistics. I then visualized the error trajectory</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_error.html">plot_error</a></span><span class="op">(</span><span class="va">result.aov</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/plot%20error%20aov-1.png" class="r-plt" alt="Plot Error Trajectory for AOV." width="600" style="display: block; margin: auto auto auto 0;"></p>
<p>and illustrated the estimated versus target effects with</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_summary.html">plot_summary</a></span><span class="op">(</span><span class="va">result.aov</span>, standardised <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/plot%20summary%20aov-1.png" class="r-plt" alt="Plot Summary for AOV." width="600" style="display: block; margin: auto auto auto 0;">
. Finally, I saved the RMSE and relevant statistics,</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_rmse.html">get_rmse</a></span><span class="op">(</span><span class="va">result.aov</span><span class="op">)</span></span>
<span><span class="co">#&gt; $rmse_F</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="../reference/get_stats.html">get_stats</a></span><span class="op">(</span><span class="va">result.aov</span><span class="op">)</span></span>
<span><span class="co">#&gt; $model</span></span>
<span><span class="co">#&gt; Anova Table (Type 3 tests)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Response: outcome</span></span>
<span><span class="co">#&gt;                 num Df den Df    MSE       F     ges    Pr(&gt;F)    </span></span>
<span><span class="co">#&gt; Factor1              1     15 3072.2 30.4789 0.44810 5.872e-05 ***</span></span>
<span><span class="co">#&gt; Factor2              1     15 1186.0  0.0304 0.00031    0.8640    </span></span>
<span><span class="co">#&gt; Factor1:Factor2      1     15 2166.8  0.2234 0.00418    0.6433    </span></span>
<span><span class="co">#&gt; ---</span></span>
<span><span class="co">#&gt; Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $F_value</span></span>
<span><span class="co">#&gt; [1] 30.4789024  0.0303541  0.2233733</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt; [1] 543 536 614 618</span></span></code></pre></div>
<p>extracted the simulated dataset and inspected its distribution.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data.aov</span> <span class="op">&lt;-</span> <span class="va">result.aov</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data.aov</span><span class="op">)</span></span>
<span><span class="co">#&gt;   ID Factor1 Factor2  outcome</span></span>
<span><span class="co">#&gt; 1  1       1       1 628.7339</span></span>
<span><span class="co">#&gt; 2  1       1       2 516.6337</span></span>
<span><span class="co">#&gt; 3  1       2       1 622.0609</span></span>
<span><span class="co">#&gt; 4  1       2       2 677.6714</span></span>
<span><span class="co">#&gt; 5  2       1       1 533.6981</span></span>
<span><span class="co">#&gt; 6  2       1       2 556.1095</span></span>
<span><span class="fu"><a href="../reference/plot_histogram.html">plot_histogram</a></span><span class="op">(</span><span class="va">data.aov</span><span class="op">[</span>,<span class="fl">4</span>, drop <span class="op">=</span> <span class="cn">FALSE</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="co">#&gt; $outcome</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/data%20aov-1.png" class="r-plt" alt="Plot Histogram for AOV." width="600" style="display: block; margin: auto auto auto 0;"></p>
<p>Additionally, I executed the ANOVA module in multiple parallel runs
to quantify both the convergence variability of RMSE within each run
(compared to the target values) and the variability of RMSE across runs
(compared to the average simulated values).</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result.parallel.aov</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parallel_aov.html">parallel_aov</a></span><span class="op">(</span></span>
<span>                        parallel_start <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                        return_best_solution <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                        N <span class="op">=</span> <span class="va">N</span>,</span>
<span>                        levels <span class="op">=</span><span class="va">levels</span>,</span>
<span>                        target_group_means <span class="op">=</span> <span class="va">target_group_means</span>,</span>
<span>                        target_f_list <span class="op">=</span> <span class="va">target_f_vec</span>,</span>
<span>                        factor_type <span class="op">=</span> <span class="va">factor_type</span>,</span>
<span>                        range <span class="op">=</span> <span class="va">range</span>,</span>
<span>                        formula <span class="op">=</span> <span class="va">formula</span>,</span>
<span>                        tolerance <span class="op">=</span> <span class="fl">1e-8</span>,</span>
<span>                        max_iter <span class="op">=</span> <span class="fl">1e3</span>,</span>
<span>                        init_temp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>                        cooling_rate <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                        integer <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                        checkGrim <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>                        max_step <span class="op">=</span> <span class="fl">.1</span>,</span>
<span>                        min_decimals <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></code></pre></div>
<p>I then plotted these RMSE distributions side-by-side to compare
within versus between run variation.</p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_rmse.html">plot_rmse</a></span><span class="op">(</span><span class="va">result.parallel.aov</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/plot%20rmse%20aov-1.png" class="r-plt" alt="Plot RMSE for AOV." width="600" style="display: block; margin: auto auto auto 0;">
Note. The two clusters emerge due to the low decimal precision of the
reported F values. #</p>
</div>
<div class="section level2">
<h2 id="descriptives-and-lm-module">Descriptives and LM Module<a class="anchor" aria-label="anchor" href="#descriptives-and-lm-module"></a>
</h2>
<p>In the replication attempt by Bardwell et al. (2007) patients with
obstructive sleep apnea completed both fatigue and depression scales to
examine whether mood symptoms or apnea severity better predict daytime
fatigue [<a href="https://doi.org/10.1016/j.jad.2006.06.013" class="external-link uri">https://doi.org/10.1016/j.jad.2006.06.013</a>]. The original
study’s (Bardwell et al., 2003) raw data are not publicly available.
Here, I apply the Descriptives and LM module of the nds3 framework to
simulate a synthetic dataset that reproduces their reported summary
estimates.</p>
<div class="section level4">
<h4 id="step-1-">Step 1.<a class="anchor" aria-label="anchor" href="#step-1-"></a>
</h4>
<p>I began by extracting the relevant descriptive parameters from the
article.</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">N</span> <span class="op">=</span> <span class="fl">60</span></span>
<span><span class="va">target_mean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">48.8</span>, <span class="fl">17.3</span>, <span class="fl">12.6</span>, <span class="fl">10.8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">target_mean</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Apnea.1"</span>, <span class="st">"Apnea.2"</span>, <span class="st">"Depression"</span>, <span class="st">"Fatigue"</span><span class="op">)</span></span>
<span><span class="va">target_sd</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">27.1</span>, <span class="fl">20.1</span>, <span class="fl">11.3</span>, <span class="fl">7.3</span><span class="op">)</span></span>
<span><span class="va">integer</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">FALSE</span>, <span class="cn">FALSE</span>, <span class="cn">TRUE</span>, <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="va">range_matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/matrix.html" class="external-link">matrix</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">15</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, </span>
<span>                         <span class="fl">111</span>, <span class="fl">80.9</span>, <span class="fl">49</span>, <span class="fl">28</span><span class="op">)</span>,</span>
<span>                       nrow <span class="op">=</span> <span class="fl">2</span>, byrow <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code></pre></div>
<p>I subsequently estimated the weights</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">weight.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weights_vec.html">weights_vec</a></span><span class="op">(</span></span>
<span>  N <span class="op">=</span> <span class="va">N</span>, </span>
<span>  target_mean <span class="op">=</span>  <span class="va">target_mean</span>,</span>
<span>  target_sd <span class="op">=</span>  <span class="va">target_sd</span>, </span>
<span>  range <span class="op">=</span> <span class="va">range_matrix</span>,</span>
<span>  integer <span class="op">=</span> <span class="va">integer</span></span>
<span><span class="op">)</span></span>
<span><span class="va">weight.vec</span></span>
<span><span class="co">#&gt; [[1]]</span></span>
<span><span class="co">#&gt; [1]  1.0000 30.1046</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[2]]</span></span>
<span><span class="co">#&gt; [1]  1.0000 16.6172</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[3]]</span></span>
<span><span class="co">#&gt; [1] 1.0000 3.9154</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; [[4]]</span></span>
<span><span class="co">#&gt; [1]  1.0000 10.6053</span></span></code></pre></div>
<p>and I ran the Descriptives module with default hyperparameters.</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result.vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optim_vec.html">optim_vec</a></span><span class="op">(</span></span>
<span>  N <span class="op">=</span> <span class="va">N</span>,</span>
<span>  target_mean <span class="op">=</span> <span class="va">target_mean</span>,</span>
<span>  target_sd <span class="op">=</span> <span class="va">target_sd</span>,</span>
<span>  range <span class="op">=</span> <span class="va">range_matrix</span>,</span>
<span>  integer <span class="op">=</span> <span class="va">integer</span>,</span>
<span>  obj_weight <span class="op">=</span> <span class="va">weight.vec</span>,</span>
<span>  tolerance <span class="op">=</span> <span class="fl">1e-8</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  max_starts <span class="op">=</span> <span class="fl">3</span>,</span>
<span>  init_temp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cooling_rate <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PSO is running...</span></span>
<span><span class="co">#&gt; Converged </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; PSO is running...</span></span>
<span><span class="co">#&gt; Converged </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean 12.6 passed GRIM test. The mean is plausible.</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%</span></span>
<span><span class="co">#&gt; converged!</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Mean 10.8 passed GRIM test. The mean is plausible.</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%</span></span>
<span><span class="co">#&gt; converged!</span></span></code></pre></div>
<p>The optimization converged exactly. Inspecting</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result.vec</span><span class="op">)</span></span>
<span><span class="co">#&gt; nds3 Object Summary</span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Achieved Loss of Optimization:</span></span>
<span><span class="co">#&gt;    Apnea.1    Apnea.2 Depression    Fatigue </span></span>
<span><span class="co">#&gt;          0          0          0          0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; RMSE of Summary Statistics</span></span>
<span><span class="co">#&gt;   Means:  0 </span></span>
<span><span class="co">#&gt;   SDs:    0 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Means:</span></span>
<span><span class="co">#&gt;    Apnea.1    Apnea.2 Depression    Fatigue </span></span>
<span><span class="co">#&gt;   48.76215   17.32129   12.63333   10.80000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; SDs:</span></span>
<span><span class="co">#&gt;    Apnea.1    Apnea.2 Depression    Fatigue </span></span>
<span><span class="co">#&gt;   27.05934   20.09107   11.25357    7.30173</span></span></code></pre></div>
<p>confirms that the simulated data reproduce the published means and
SDs. I then visualized the error trajectories. For example, the error
trajectory of the fatigue variable is:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_error.html">plot_error</a></span><span class="op">(</span><span class="va">result.vec</span>, run <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/plot%20error%20vec-1.png" class="r-plt" alt="Plot Error for Vec." width="600" style="display: block; margin: auto auto auto 0;"></p>
<p>The estimated versus target descriptives are given by</p>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_summary.html">plot_summary</a></span><span class="op">(</span><span class="va">result.vec</span>, standardised <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/plot%20summary%20vec-1.png" class="r-plt" alt="Plot Summary for Vec." width="600" style="display: block; margin: auto auto auto 0;"></p>
<p>Finally, I saved the RMSE and relevant statistics,</p>
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_rmse.html">get_rmse</a></span><span class="op">(</span><span class="va">result.vec</span><span class="op">)</span></span>
<span><span class="co">#&gt; $rmse_mean</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rmse_sd</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="fu"><a href="../reference/get_stats.html">get_stats</a></span><span class="op">(</span><span class="va">result.vec</span><span class="op">)</span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;    Apnea.1    Apnea.2 Depression    Fatigue </span></span>
<span><span class="co">#&gt;   48.76215   17.32129   12.63333   10.80000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt;    Apnea.1    Apnea.2 Depression    Fatigue </span></span>
<span><span class="co">#&gt;   27.05934   20.09107   11.25357    7.30173</span></span></code></pre></div>
<p>extracted the simulated dataset and inspected its distributions and
frequencies.</p>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data.vec</span> <span class="op">&lt;-</span> <span class="va">result.vec</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data.vec</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Apnea.1   Apnea.2 Depression Fatigue</span></span>
<span><span class="co">#&gt; 1 64.97937 12.931947          6       9</span></span>
<span><span class="co">#&gt; 2 33.60681 77.679530          9       5</span></span>
<span><span class="co">#&gt; 3 77.55359 28.297373         18      23</span></span>
<span><span class="co">#&gt; 4 23.51289 80.900000         20      12</span></span>
<span><span class="co">#&gt; 5 36.03457 10.184895         11       0</span></span>
<span><span class="co">#&gt; 6 18.21944  5.208951         17       6</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="fu"><a href="../reference/plot_histogram.html">plot_histogram</a></span><span class="op">(</span><span class="va">data.vec</span><span class="op">)</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/data%20vec-1.png" class="r-plt" alt="Plot Histogram for Vec." width="800" style="display: block; margin: auto auto auto 0;"></p>
</div>
<div class="section level4">
<h4 id="step-2-">Step 2.<a class="anchor" aria-label="anchor" href="#step-2-"></a>
</h4>
<p>I began by extracting the relevant correlation and regression
parameters from the article and handing off the simulated data from the
Descriptives module for further use.</p>
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">sim_data</span> <span class="op">&lt;-</span> <span class="va">data.vec</span></span>
<span><span class="va">target_reg</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">4.020</span>, <span class="fl">0.023</span>, <span class="fl">0.008</span>, <span class="fl">0.438</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/names.html" class="external-link">names</a></span><span class="op">(</span><span class="va">target_reg</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Apnea.1"</span>, <span class="st">"Apnea.2"</span>, <span class="st">"Depression"</span>, <span class="st">"Fatigue"</span><span class="op">)</span></span>
<span><span class="va">target_se</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">0.034</span>, <span class="fl">0.048</span>, <span class="fl">0.066</span><span class="op">)</span></span>
<span><span class="va">target_cor</span> <span class="op">&lt;-</span>  <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="cn">NA</span>, <span class="cn">NA</span>, <span class="fl">0.11</span>, <span class="fl">0.20</span>, <span class="fl">0.68</span><span class="op">)</span></span>
<span><span class="va">reg_equation</span> <span class="op">&lt;-</span> <span class="st">"Fatigue ~ Apnea.1 + Apnea.2 + Depression"</span></span></code></pre></div>
<p>I subsequently estimated the weights</p>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result.weight.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/weights_est.html">weights_est</a></span><span class="op">(</span></span>
<span>  sim_runs <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  sim_data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  reg_equation <span class="op">=</span> <span class="va">reg_equation</span>,</span>
<span>  target_cor <span class="op">=</span> <span class="va">target_cor</span>,</span>
<span>  target_reg <span class="op">=</span> <span class="va">target_reg</span>,</span>
<span>  target_se <span class="op">=</span> <span class="va">target_se</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-8</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  init_temp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cooling_rate <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Best error in start 1 is 0.003585686 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; The estimated weights are: 1 1.14</span></span>
<span><span class="va">weight.lm</span> <span class="op">&lt;-</span> <span class="va">result.weight.lm</span><span class="op">$</span><span class="va">weights</span></span>
<span><span class="va">weight.lm</span></span>
<span><span class="co">#&gt; [1] 1.00 1.14</span></span></code></pre></div>
<p>and I ran the LM module with default hyperparameters.</p>
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/optim_lm.html">optim_lm</a></span><span class="op">(</span></span>
<span>  sim_data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  reg_equation <span class="op">=</span> <span class="va">reg_equation</span>,</span>
<span>  target_cor <span class="op">=</span> <span class="va">target_cor</span>,</span>
<span>  target_reg <span class="op">=</span> <span class="va">target_reg</span>,</span>
<span>  target_se <span class="op">=</span> <span class="va">target_se</span>,</span>
<span>  weight <span class="op">=</span> <span class="va">weight.lm</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-8</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  max_starts <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  init_temp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cooling_rate <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span>
<span><span class="co">#&gt;   |                                                                              |                                                                      |   0%  |                                                                              |=                                                                     |   1%  |                                                                              |=                                                                     |   2%  |                                                                              |==                                                                    |   3%  |                                                                              |===                                                                   |   4%  |                                                                              |====                                                                  |   5%  |                                                                              |====                                                                  |   6%  |                                                                              |=====                                                                 |   7%  |                                                                              |======                                                                |   8%  |                                                                              |======                                                                |   9%  |                                                                              |=======                                                               |  10%  |                                                                              |========                                                              |  11%  |                                                                              |========                                                              |  12%  |                                                                              |=========                                                             |  13%  |                                                                              |==========                                                            |  14%  |                                                                              |==========                                                            |  15%  |                                                                              |===========                                                           |  16%  |                                                                              |============                                                          |  17%  |                                                                              |=============                                                         |  18%  |                                                                              |=============                                                         |  19%  |                                                                              |==============                                                        |  20%  |                                                                              |===============                                                       |  21%  |                                                                              |===============                                                       |  22%  |                                                                              |================                                                      |  23%  |                                                                              |=================                                                     |  24%  |                                                                              |==================                                                    |  25%  |                                                                              |==================                                                    |  26%  |                                                                              |===================                                                   |  27%  |                                                                              |====================                                                  |  28%  |                                                                              |====================                                                  |  29%  |                                                                              |=====================                                                 |  30%  |                                                                              |======================                                                |  31%  |                                                                              |======================                                                |  32%  |                                                                              |=======================                                               |  33%  |                                                                              |========================                                              |  34%  |                                                                              |========================                                              |  35%  |                                                                              |=========================                                             |  36%  |                                                                              |==========================                                            |  37%  |                                                                              |===========================                                           |  38%  |                                                                              |===========================                                           |  39%  |                                                                              |============================                                          |  40%  |                                                                              |=============================                                         |  41%  |                                                                              |=============================                                         |  42%  |                                                                              |==============================                                        |  43%  |                                                                              |===============================                                       |  44%  |                                                                              |================================                                      |  45%  |                                                                              |================================                                      |  46%  |                                                                              |=================================                                     |  47%  |                                                                              |==================================                                    |  48%  |                                                                              |==================================                                    |  49%  |                                                                              |===================================                                   |  50%  |                                                                              |====================================                                  |  51%  |                                                                              |====================================                                  |  52%  |                                                                              |=====================================                                 |  53%  |                                                                              |======================================                                |  54%  |                                                                              |======================================                                |  55%  |                                                                              |=======================================                               |  56%  |                                                                              |========================================                              |  57%  |                                                                              |=========================================                             |  58%  |                                                                              |=========================================                             |  59%  |                                                                              |==========================================                            |  60%  |                                                                              |===========================================                           |  61%  |                                                                              |===========================================                           |  62%  |                                                                              |============================================                          |  63%  |                                                                              |=============================================                         |  64%  |                                                                              |==============================================                        |  65%  |                                                                              |==============================================                        |  66%  |                                                                              |===============================================                       |  67%  |                                                                              |================================================                      |  68%  |                                                                              |================================================                      |  69%  |                                                                              |=================================================                     |  70%  |                                                                              |==================================================                    |  71%  |                                                                              |==================================================                    |  72%  |                                                                              |===================================================                   |  73%  |                                                                              |====================================================                  |  74%  |                                                                              |====================================================                  |  75%  |                                                                              |=====================================================                 |  76%  |                                                                              |======================================================                |  77%  |                                                                              |=======================================================               |  78%  |                                                                              |=======================================================               |  79%  |                                                                              |========================================================              |  80%  |                                                                              |=========================================================             |  81%  |                                                                              |=========================================================             |  82%  |                                                                              |==========================================================            |  83%  |                                                                              |===========================================================           |  84%  |                                                                              |============================================================          |  85%  |                                                                              |============================================================          |  86%  |                                                                              |=============================================================         |  87%  |                                                                              |==============================================================        |  88%  |                                                                              |==============================================================        |  89%  |                                                                              |===============================================================       |  90%  |                                                                              |================================================================      |  91%  |                                                                              |================================================================      |  92%  |                                                                              |=================================================================     |  93%  |                                                                              |==================================================================    |  94%  |                                                                              |==================================================================    |  95%  |                                                                              |===================================================================   |  96%  |                                                                              |====================================================================  |  97%  |                                                                              |===================================================================== |  98%  |                                                                              |===================================================================== |  99%  |                                                                              |======================================================================| 100%</span></span>
<span><span class="co">#&gt; Best error in start 1 is 0.005876413</span></span></code></pre></div>
<p>The optimization converged with reaching Max Iterations and a low
RMSE. Inspecting</p>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">result.lm</span><span class="op">)</span></span>
<span><span class="co">#&gt; nds3 Object Summary</span></span>
<span><span class="co">#&gt; -------------------------------------------------</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Achieved Loss of Optimization:  0.005876413 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; RMSE of Summary Statistics</span></span>
<span><span class="co">#&gt;   Correlations:             0 </span></span>
<span><span class="co">#&gt;   Regression Coefficients:  0 </span></span>
<span><span class="co">#&gt;   Standard Errors:          0.007874008 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Regression Model:</span></span>
<span><span class="co">#&gt; "Fatigue ~ Apnea.1 + Apnea.2 + Depression" </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Simulated Data Summary:</span></span>
<span><span class="co">#&gt;   Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)     Apnea.1     Apnea.2  Depression </span></span>
<span><span class="co">#&gt; 4.020195771 0.022764103 0.008178164 0.437582155 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Std. Errors:</span></span>
<span><span class="co">#&gt; (Intercept)     Apnea.1     Apnea.2  Depression </span></span>
<span><span class="co">#&gt;  1.70379530  0.02619971  0.03653964  0.06521655 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Correlations:</span></span>
<span><span class="co">#&gt; [1] -0.05049437  0.04474935  0.26319808  0.11340425  0.19574643  0.68410829</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   Means:</span></span>
<span><span class="co">#&gt;    Apnea.1    Apnea.2 Depression    Fatigue </span></span>
<span><span class="co">#&gt;   48.76215   17.32129   12.63333   10.80000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt;   SDs:</span></span>
<span><span class="co">#&gt;    Apnea.1    Apnea.2 Depression    Fatigue </span></span>
<span><span class="co">#&gt;   27.05934   20.09107   11.25357    7.30173</span></span></code></pre></div>
<p>confirms that the simulated data closely reproduce the published
regression and correlation parameters. I then visualized the error,</p>
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_error.html">plot_error</a></span><span class="op">(</span><span class="va">result.lm</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/plot%20error%20lm-1.png" class="r-plt" alt="Plot Error for LM." width="600" style="display: block; margin: auto auto auto 0;">
the error-ratio trajectories,</p>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_error_ratio.html">plot_error_ratio</a></span><span class="op">(</span><span class="va">result.lm</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/error%20ratio%20lm-1.png" class="r-plt" alt="Plot Error Ration for LM." width="600" style="display: block; margin: auto auto auto 0;">
and illustrated the estimated versus target descriptives with</p>
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_summary.html">plot_summary</a></span><span class="op">(</span><span class="va">result.lm</span>, standardised <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/plot%20summary%20lm-1.png" class="r-plt" alt="Plot Summary for LM." width="600" style="display: block; margin: auto auto auto 0;"></p>
<p>Finally, I saved the RMSE and relevant statistics,</p>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/get_rmse.html">get_rmse</a></span><span class="op">(</span><span class="va">result.lm</span><span class="op">)</span></span>
<span><span class="co">#&gt; $rmse_cor</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rmse_reg</span></span>
<span><span class="co">#&gt; [1] 0</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $rmse_se</span></span>
<span><span class="co">#&gt; [1] 0.007874008</span></span>
<span><span class="fu"><a href="../reference/get_stats.html">get_stats</a></span><span class="op">(</span><span class="va">result.lm</span><span class="op">)</span></span>
<span><span class="co">#&gt; $model</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Call:</span></span>
<span><span class="co">#&gt; stats::lm(formula = eq, data = data_df)</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; Coefficients:</span></span>
<span><span class="co">#&gt; (Intercept)      Apnea.1      Apnea.2   Depression  </span></span>
<span><span class="co">#&gt;    4.020196     0.022764     0.008178     0.437582  </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $reg</span></span>
<span><span class="co">#&gt; (Intercept)     Apnea.1     Apnea.2  Depression </span></span>
<span><span class="co">#&gt; 4.020195771 0.022764103 0.008178164 0.437582155 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $se</span></span>
<span><span class="co">#&gt; (Intercept)     Apnea.1     Apnea.2  Depression </span></span>
<span><span class="co">#&gt;  1.70379530  0.02619971  0.03653964  0.06521655 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $cor</span></span>
<span><span class="co">#&gt; [1] -0.05049437  0.04474935  0.26319808  0.11340425  0.19574643  0.68410829</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $mean</span></span>
<span><span class="co">#&gt;    Apnea.1    Apnea.2 Depression    Fatigue </span></span>
<span><span class="co">#&gt;   48.76215   17.32129   12.63333   10.80000 </span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $sd</span></span>
<span><span class="co">#&gt;    Apnea.1    Apnea.2 Depression    Fatigue </span></span>
<span><span class="co">#&gt;   27.05934   20.09107   11.25357    7.30173</span></span></code></pre></div>
<p>extracted the simulated dataset and inspected its partial regression
plots.</p>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">data.lm</span> <span class="op">&lt;-</span> <span class="va">result.lm</span><span class="op">$</span><span class="va">data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html" class="external-link">head</a></span><span class="op">(</span><span class="va">data.lm</span><span class="op">)</span></span>
<span><span class="co">#&gt;    Apnea.1    Apnea.2 Depression Fatigue</span></span>
<span><span class="co">#&gt; 1 58.36190 39.2568653         17       9</span></span>
<span><span class="co">#&gt; 2 15.00000  0.4791305         26       5</span></span>
<span><span class="co">#&gt; 3 46.53431 43.8387514         16      23</span></span>
<span><span class="co">#&gt; 4 51.52888 31.8596164         12      12</span></span>
<span><span class="co">#&gt; 5 18.84405  7.8001462          2       0</span></span>
<span><span class="co">#&gt; 6 89.73526 49.3039396          5       6</span></span>
<span><span class="va">partial.plots</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/plot_partial_regression.html">plot_partial_regression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html" class="external-link">lm</a></span><span class="op">(</span><span class="va">reg_equation</span>, <span class="va">data.lm</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu">gridExtra</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/gridExtra/man/arrangeGrob.html" class="external-link">grid.arrange</a></span><span class="op">(</span>grobs <span class="op">=</span> <span class="va">partial.plots</span>, ncol <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/data%20lm-1.png" class="r-plt" alt="Plot Partial Regressions for LM." width="1100" style="display: block; margin: auto auto auto 0;"></p>
<p>Additionally, I executed the LM module in multiple parallel runs to
quantify both the convergence variability of RMSE within each run
(compared to the target values) and the variability of RMSE across runs
(compared to the average simulated values).</p>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">result.parallel.lm</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/parallel_lm.html">parallel_lm</a></span><span class="op">(</span></span>
<span>  parallel_start <span class="op">=</span> <span class="fl">100</span>,</span>
<span>  return_best_solution <span class="op">=</span> <span class="cn">FALSE</span>,</span>
<span>  sim_data <span class="op">=</span> <span class="va">sim_data</span>,</span>
<span>  reg_equation <span class="op">=</span> <span class="va">reg_equation</span>,</span>
<span>  target_cor <span class="op">=</span> <span class="va">target_cor</span>,</span>
<span>  target_reg <span class="op">=</span> <span class="va">target_reg</span>,</span>
<span>  target_se <span class="op">=</span> <span class="va">target_se</span>,</span>
<span>  weight <span class="op">=</span> <span class="va">weight.lm</span>,</span>
<span>  tol <span class="op">=</span> <span class="fl">1e-8</span>,</span>
<span>  max_iter <span class="op">=</span> <span class="fl">1e5</span>,</span>
<span>  max_starts <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  init_temp <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  cooling_rate <span class="op">=</span> <span class="cn">NULL</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>I then plotted these RMSE distributions side-by-side to compare
within versus between run variation.</p>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_rmse.html">plot_rmse</a></span><span class="op">(</span><span class="va">result.parallel.lm</span><span class="op">)</span></span></code></pre></div>
<p><img src="nds3_application_files/figure-html/plot%20rmse%20lm-1.png" class="r-plt" alt="Plot RMSE for LM." width="1000" style="display: block; margin: auto auto auto 0;"></p>
</div>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Sebastian A. J. Lortz.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
